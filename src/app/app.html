<div class="min-h-screen bg-gray-100 p-4 md:p-8 font-sans">
  
  <header class="mb-8">
    <h1 class="text-2xl font-bold text-gray-800">Panel de Control de Ventas</h1>
    <p class="text-gray-500 text-sm">Stack: Angular + Node.js + Firebase + G2Plot</p>
  </header>

  <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">
  
  <div class="bg-white p-6 rounded-xl shadow-sm border-l-4 border-blue-500">
    <div class="flex items-center">
      <div class="p-3 rounded-full bg-blue-100 text-blue-600">
        <i nz-icon nzType="dollar" class="text-xl"></i>
      </div>
      <div class="ml-4">
        <p class="text-sm font-medium text-gray-500 uppercase">Total Ventas</p>
        <p class="text-2xl font-bold text-gray-800">{{ totalVentas | currency:'S/.' }}</p>
      </div>
    </div>
  </div>

  <div class="bg-white p-6 rounded-xl shadow-sm border-l-4 border-green-500">
    <div class="flex items-center">
      <div class="p-3 rounded-full bg-green-100 text-green-600">
        <i nz-icon nzType="line-chart" class="text-xl"></i>
      </div>
      <div class="ml-4">
        <p class="text-sm font-medium text-gray-500 uppercase">Venta Promedio</p>
        <p class="text-2xl font-bold text-gray-800">{{ promedioVentas | currency:'S/.' }}</p>
      </div>
    </div>
  </div>

  <div class="bg-white p-6 rounded-xl shadow-sm border-l-4 border-purple-500">
    <div class="flex items-center">
      <div class="p-3 rounded-full bg-purple-100 text-purple-600">
        <i nz-icon nzType="shopping-cart" class="text-xl"></i>
      </div>
      <div class="ml-4">
        <p class="text-sm font-medium text-gray-500 uppercase">Transacciones</p>
        <p class="text-2xl font-bold text-gray-800">{{ totalTransacciones }}</p>
      </div>
    </div>
  </div>

</div>

  <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
    
    <div class="lg:col-span-1">
      <nz-card nzTitle="Ingresar Nueva Venta" class="shadow-md rounded-lg border-none">
        <nz-skeleton [nzActive]="true" [nzLoading]="isConfigLoading">
          <div class="flex flex-col gap-4">
            <div>
              <label class="block text-xs font-semibold text-gray-400 uppercase mb-1">Categoría</label>
              <nz-select class="w-full" [(ngModel)]="nuevaVenta.categoria" (ngModelChange)="onCategoriaChange($event, 'form')">
                <nz-option *ngFor="let cat of categorias" [nzValue]="cat" [nzLabel]="cat"></nz-option>
              </nz-select>
            </div>

            <div>
              <label class="block text-xs font-semibold text-gray-400 uppercase mb-1">Marca</label>
              <nz-select class="w-full" [(ngModel)]="nuevaVenta.marca" [nzDisabled]="!nuevaVenta.categoria">
                <nz-option *ngFor="let m of marcasForm" [nzValue]="m" [nzLabel]="m"></nz-option>
              </nz-select>
            </div>

            <div>
              <label class="block text-xs font-semibold text-gray-400 uppercase mb-1">Monto (S/.)</label>
              <nz-input-number class="w-full" [(ngModel)]="nuevaVenta.monto" [nzMin]="0"></nz-input-number>
            </div>

            <button 
              nz-button 
              nzType="primary" 
              [nzLoading]="isSaving" 
              (click)="guardar()" 
              class="w-full h-10 mt-2 bg-blue-600 border-none rounded-md font-medium transition-colors">
              Guardar
            </button>
          </div>
        </nz-skeleton>
      </nz-card>
    </div>

    <div class="lg:col-span-2">
      <nz-card nzTitle="Análisis Visual" class="shadow-md rounded-lg border-none">
        
        <nz-spin [nzSpinning]="isChartLoading" nzTip="Actualizando datos...">
          
          <div class="flex flex-wrap gap-3 mb-6 bg-blue-50 p-4 rounded-lg">
            <div class="flex items-center gap-2">
              <span class="text-sm text-blue-800 font-medium">Filtrar por:</span>
              <nz-select 
                class="w-36 md:w-44" 
                [(ngModel)]="catSeleccionada" 
                (ngModelChange)="onCategoriaChange($event, 'filtro')">
                <nz-option nzValue="Todas" nzLabel="Todas las categorías"></nz-option>
                <nz-option *ngFor="let cat of categorias" [nzValue]="cat" [nzLabel]="cat"></nz-option>
              </nz-select>
            </div>

            <div class="flex items-center gap-2">
              <nz-select 
                class="w-36 md:w-44" 
                [(ngModel)]="marcaSeleccionada" 
                (ngModelChange)="aplicarFiltros()"
                [nzDisabled]="catSeleccionada === 'Todas'">
                <nz-option nzValue="Todas" nzLabel="Todas las marcas"></nz-option>
                <nz-option *ngFor="let m of marcasFiltro" [nzValue]="m" [nzLabel]="m"></nz-option>
              </nz-select>
            </div>
          </div>

          <div class="w-full bg-white rounded-md p-2">
            <div [hidden]="ventasRaw.length === 0" 
                id="container-grafico" 
                class="h-80 w-full" 
                [style.opacity]="isChartLoading ? 0.3 : 1">
            </div>
            
            <div *ngIf="ventasRaw.length === 0 && !isChartLoading" class="h-80 flex flex-col items-center justify-center border-2 border-dashed border-gray-100 rounded-lg">
              <nz-empty 
                nzNotFoundImage="https://gw.alipayobjects.com/zos/antfincdn/ZHrcdLPrvN/empty.svg" 
                [nzNotFoundContent]="contentTpl">
                <ng-template #contentTpl>
                  <span class="text-gray-400">No se encontraron registros para este filtro</span>
                </ng-template>
              </nz-empty>
            </div>
          </div>

        </nz-spin>

      </nz-card>
    </div>

  </div>
</div>